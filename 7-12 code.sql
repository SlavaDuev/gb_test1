CREATE DATABASE Друзья_человека;
USE Друзья_человека;

-- Таблица для всех животных
CREATE TABLE Животные (
    id INT AUTO_INCREMENT PRIMARY KEY,
    имя VARCHAR(100),
    вид VARCHAR(100),
    команда VARCHAR(255),
    дата_рождения DATE
);

-- Таблица для домашних животных
CREATE TABLE Домашние_животные (
    id INT AUTO_INCREMENT PRIMARY KEY,
    имя VARCHAR(100),
    команда VARCHAR(255),
    дата_рождения DATE
);

-- Таблица для вьючных животных
CREATE TABLE Вьючные_животные (
    id INT AUTO_INCREMENT PRIMARY KEY,
    имя VARCHAR(100),
    команда VARCHAR(255),
    дата_рождения DATE
);

-- Заполнение таблицы домашних животных
INSERT INTO Домашние_животные (имя, команда, дата_рождения)
VALUES 
('Барсик', 'сидеть', '2021-03-10'),
('Рекс', 'апорт', '2020-06-21'),
('Пушок', 'бежать', '2022-11-05');

-- Заполнение таблицы вьючных животных
INSERT INTO Вьючные_животные (имя, команда, дата_рождения)
VALUES 
('Буцефал', 'идти', '2018-04-10'),
('Ганнибал', 'стоять', '2017-08-14'),
('Тяжеловоз', 'нести', '2019-02-23');

-- Удаление всех верблюдов
DELETE FROM Вьючные_животные WHERE имя = 'Ганнибал';

-- Объединение таблиц Лошади и Ослы (в данном случае представлено вьючными животными)
CREATE TABLE Лошади_И_Осёлы AS
SELECT * FROM Вьючные_животные
WHERE имя IN ('Буцефал', 'Тяжеловоз');

CREATE TABLE Молодые_животные AS
SELECT *, 
    TIMESTAMPDIFF(MONTH, дата_рождения, CURDATE()) AS возраст_в_месяцах
FROM Животные
WHERE TIMESTAMPDIFF(YEAR, дата_рождения, CURDATE()) BETWEEN 1 AND 3;

CREATE TABLE Все_животные AS
SELECT id, имя, 'Домашние' AS тип_животного, команда, дата_рождения 
FROM Домашние_животные
UNION
SELECT id, имя, 'Вьючные' AS тип_животного, команда, дата_рождения 
FROM Вьючные_животные
UNION
SELECT id, имя, 'Молодые' AS тип_животного, команда, дата_рождения 
FROM Молодые_животные;

